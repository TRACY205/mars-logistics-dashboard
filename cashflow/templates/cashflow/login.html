<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Login - Mars Logistics</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-green-100 to-green-200 flex items-center justify-center min-h-screen font-sans">

<div class="bg-white p-8 rounded-3xl shadow-2xl w-full max-w-md">

    <h2 class="text-3xl font-bold text-center text-green-700 mb-6">ðŸŒ¿ Login</h2>

    <!-- Messages -->
    {% if messages %}
        <div class="mb-4">
            {% for message in messages %}
                <div class="p-3 rounded-lg text-white
                    {% if message.tags == 'error' %} bg-red-500 
                    {% elif message.tags == 'success' %} bg-green-500 
                    {% else %} bg-gray-500 {% endif %}">
                    {{ message }}
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <!-- Admin Login Form -->
    <form id="adminForm" method="POST" action="{% url 'login' %}" class="space-y-4 hidden">
        {% csrf_token %}
        <input type="hidden" name="login_type" value="admin">
        <div>
            <label>Username</label>
            <input type="text" name="username" required class="w-full border px-3 py-2 rounded-xl">
        </div>
        <div>
            <label>Password</label>
            <input type="password" name="password" required class="w-full border px-3 py-2 rounded-xl">
        </div>
        <button type="submit" class="w-full bg-green-600 text-white py-2 rounded-xl">Login as Admin</button>
    </form>

    <!-- User Login Form -->
    <form id="userForm" method="POST" action="{% url 'login' %}" class="space-y-4 hidden">
        {% csrf_token %}
        <input type="hidden" name="login_type" value="user">
        <div>
            <label>Username</label>
            <input type="text" name="username" required class="w-full border px-3 py-2 rounded-xl">
        </div>
        <div>
            <label>Password</label>
            <input type="password" name="password" required class="w-full border px-3 py-2 rounded-xl">
        </div>
        <button type="submit" class="w-full bg-green-500 text-white py-2 rounded-xl">Login as User</button>
    </form>

    <p class="text-center text-gray-600 mt-6">
        New user? <a href="{% url 'register' %}" class="text-green-600 font-bold hover:underline">Register here</a>
    </p>

    <div class="text-center mt-6">
        <a href="{% url 'landing' %}" class="inline-block bg-green-600 text-white py-2 px-6 rounded-xl">â¬… Back to Landing</a>
    </div>

</div>

<!-- JS to show correct form based on landing page button -->
<script>
    const adminForm = document.getElementById('adminForm');
    const userForm = document.getElementById('userForm');

    // Show correct form based on query param from Django
    const role = "{{ role }}";  // passed from views.py context
    if (role === "admin") {
        adminForm.classList.remove('hidden');
    } else if (role === "user") {
        userForm.classList.remove('hidden');
    }
</script>

</body>
</html>
